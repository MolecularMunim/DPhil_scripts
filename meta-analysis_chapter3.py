from scipy.stats import combine_pvalues
from scipy.stats import combine_pvalues

# a list of lists of p-values
tests = [
['2.40E-20', '1.26E-26', '0.767242312', '2.56E-36', '1.63E-33', '8.62E-77'],
['0.000299114', '3.86E-15', '1.68E-15', '0.124220333', '0.158323541', '0.00062919', '0.048704333'],
['0.006241477', '5.12E-17', '0.599659929', '0.71284936', '0.026628258', '0.281998351', '0.256122042'],
['0.004161538', '0.001290076', '2.72E-18', '0.075791662', '4.58E-05', '0.03296407', '9.61E-08'],
['0.851826093', '9.87E-09', '6.52E-07', '0.023165695', '0.015353459', '0.016257803', '6.25E-13'],
['0.073504191', '6.61E-10', '0.377907722', '0.05075704', '0.00987856', '6.60E-08', '3.53E-15'],
['0.210117391', '0.145196941', '0.588015124', '0.677704924', '0.053812717', '4.46E-05', '6.18E-16'],
['0.119759957', '0.004136193', '0.826724388', '0.266969332', '0.035660428', '6.33E-06', '1.48E-06'],
['0.126292795', '5.67E-06', '0.070528685', '0.875137201', '0.023316873', '6.90E-05', '9.37E-07'],
['0.332627179', '3.65E-12', '3.71E-10', '0.96500682', '0.061769502', '0.201033668', '0.008536209'],
['0.003503591', '0.002914965', '0.047052518', '0.362003219', '0.463053576', '0.091324287', '0.00721202'],
['0.030966738', '0.466006151', '0.25206758', '0.128932725', '0.422066378', '0.013766031', '0.063481009'],
['0.002453503', '1.01E-27', '2.25E-11', '0.895500119', '0.107855815', '2.02E-05', '0.000912773'],
['0.068125363', '1.16E-05', '0.876577352', '0.682766835', '1'],
['0.121491095', '0.969485976', '0.003306507', '0.69961087', '0.229004598', '0.063668538', '0.604673144'],
['0.251367019', '0.197312503', '0.471641339', '0.7354272', '0.02491763', '0.677684822', '0.576546673'],
['0.520492055', '0.00211672', '0.935326582', '0.490178969', '0.104368219'],
['1', '0.047903124', '0.475645601', '0.267906474', '0.429416159'],
['0.068084015', '0.014802637', '0.759101746', '0.275445423', '1'],
['0.384261721', '6.13E-41', '0.748088688', '0.220552497', '0.710395296', '0.331098894', '0.495183258'],
['0.363513079', '1.26E-15', '0.116735425', '0.197115293', '0.140327101', '0.804817156', '0.351410479'],
['0.138040843', '0.00019899', '0.562770681', '0.861468121', '0.031444805', '0.706566146', '0.471713843'],
['0.284473405', '0.074095205', '0.198887884', '0.737510027'],
['0.216190667', '0.209331605', '0.00033724', '0.43869593', '0.306519973', '0.614820552', '0.883342683'],
['0.400778021', '7.99E-15', '0.134982001', '0.100423372', '0.134109408', '0.613818617', '0.089160328'],
['0.470142275', '3.61E-06', '0.915495092', '0.04275335', '0.365288066', '1', '0.026232848'],
['0.702577253', '0.990815716', '0.422337816', '0.824639534', '0.643876357', '0.249716019', '0.206375426'],
['0.51958096', '0.113573264', '0.162429782', '0.490178969', '0.095256332', '0.302759712', '0.443339842'],
['0.030738242', '0.029739663', '0.137675951', '0.611375515', '0.764198604', '1', '0.898671059'],
['0.142492467', '0.042151887', '0.986518062'],
['0.105119609', '0.000404389', '1.15E-09', '0.043853405', '0.409590665', '0.244140206', '0.910066176'],
['1', '0.005938162', '0.119590661', '0.735336823', '1'],
['0.026748953', '0.000160683', '0.250894514', '0.12661958', '0.623766336', '0.72997432', '0.465750105'],
['0.082244116', '0.012541691', '0.3893896', '0.024993997', '0.244404825', '0.414099137', '0.762529608'],
['0.142492467', '0.095451131', '0.881877399', '0.148126828', '0.234928879'],
['1', '0.000517207', '0.188756192', '1', '0.148126828', '0.234928879'],
['0.448149139', '0.032156638', '0.277815436', '0.655338749', '0.659279268', '0.191287317', '0.386766805'],
['0.005369667', '1.55E-10', '2.99E-09', '0.616973443', '0.017205195', '0.091529573', '0.059867652'],
['0.004940004', '0.402792102', '0.509771534'],
['0.00256563', '7.18E-24', '1.50E-17', '0.323352999', '0.354609794', '0.528499264', '0.12201876'],
['0.142403514', '0.006426258', '0.052885387', '1', '1'],
['0.014482738', '8.84E-14', '8.17E-11', '0.031123118', '0.239481454', '0.37428527', '0.49785938'],
['0.097756281', '0.473189739', '1', '0.148126828'],
['0.142397768', '0.000337127', '0.794182973', '0.271934354'],
['0.800609831', '4.66E-08', '1.09E-15', '0.398604236', '0.430975383', '0.249885308', '0.315769954'],
['0.519541059', '9.52E-06', '0.006881159', '1'],
['0.024949677', '0.305137997', '0.568510873', '0.052632893', '0.424107613', '0.695835831', '0.44476314'],
['0.22059657', '0.087388215', '1', '0.14600694'],
['0.110200654', '1.07E-14', '9.59E-11', '0.186966598', '0.032776305', '0.101326698', '0.341260772'],
['0.236411148', '0.017720512', '0.551220572', '0.029058317', '0.00326073', '0.719973999', '0.205553561'],
['6.00E-08', '0.000102999', '8.13E-39', '0.161755096', '0.000408467', '0.000805197', '2.83E-09'],
['0.519103042', '0.721334905', '0.153421276', '0.539349299', '1', '0.433223442'],
['1', '0.029300712', '0.070594589', '0.721168619', '0.362623097', '0.016378394'],
['0.142407923', '0.21671626', '0.112059302', '0.490178969', '1'],
['0.068092866', '1.86E-05', '0.403818663', '1'],
['0.640575847', '1.96E-07', '0.04048619', '0.154286608', '0.302648349'],
['0.643872512', '0.000957652', '0.058182994', '0.601541584', '0.770989207', '0.974138513'],
['0.871790064', '0.235696954', '0.000579232', '0.75727824', '0.24708436', '0.727194643', '0.000553017'],
['0.221865107', '1.25E-11', '0.337892265', '0.563052158', '0.008216468', '0.268791611'],
['0.014209394', '1.21E-05', '0.134806349', '0.502376991', '0.494976452'],
['1', '5.01E-05', '0.009592926', '0.330315643', '0.14805104', '0.171206826'],
['0.068093861', '0.183351122', '0.873514005', '0.540203372', '0.770989207'],
['0.142418309', '0.001301233', '0.790425787', '1'],
['0.274848192', '0.000334642', '1', '1', '0.267906474', '0.037771631'],
['0.386332855', '0.007317158', '0.191220066', '0.267906474', '0.037771631'],
['0.065598009', '2.23E-14', '0.278353036', '0.320087709', '1', '0.263867545'],
['0.010263594', '1.02E-24', '0.709587441', '0.978426487', '0.658493984', '0.794680039'],
['0.285261419', '0.00195934', '0.151814965', '1', '0.154286608', '0.30265978'],
['1', '1.47E-07', '0.325252666', '0.28562654', '0.148016067'],
['0.20502307', '1.37E-05', '0.391459616', '0.540138819', '0.302800077', '0.787822186'],
['0.154126474', '1.07E-09', '0.80993703', '0.760904698', '0.148016067', '0.385495855'],
['0.253225199', '3.47E-09', '0.550937314', '1', '0.21482572'],
['1', '1.50E-10', '0.350983351', '1'],
['0.644347121', '1.83E-09', '0.66490897', '0.735336823', '0.468115071'],
['0.032712585', '0.000614408', '0.627795631', '0.132060727', '1'],
['0.011244597', '0.040823645', '0.018171793', '0.033614222', '0.0027224', '1', '0.30298353'],
['0.654824214', '2.00E-24', '0.357006096', '0.721168619', '0.148126828', '0.234928879'],
['1', '1.18E-18', '0.658186238', '0.332991601', '0.148126828', '0.234928879'],
['0.008237918', '1.91E-16', '0.308844781', '0.06461157', '1', '0.283431179'],
['0.292512482', '2.08E-12', '0.616217957', '0.534403105', '1', '0.456329418'],
['0.314050299', '2.64E-14', '0.510758858', '0.92538221', '0.269267816', '1', '0.709685608'],
['0.868505357', '4.41E-10', '0.929941766', '0.435820154', '0.267906474', '0.102787976'],
['0.123878613', '4.46E-32', '0.004422378', '0.176152152', '1', '0.947833357'],
['0.028502634', '5.50E-12', '0.194039727', '0.608302961', '1', '0.185176305'],
['1', '0.718128123', '0.051929161', '0.039811787', '0.00277763', '1', '0.885134975'],
['0.508951116', '6.57E-11', '0.317689331', '0.682135085', '0.269267816', '1', '0.100224722'],
['0.128084393', '4.59E-17', '0.256085952', '0.37112575', '0.037703529', '0.471133735'],
['0.035287876', '1.20E-12', '0.501188048', '0.308678679', '0.270629172', '1', '0.251050188'],
['0.142397768', '3.73E-22', '0.337980484', '0.740254197', '1', '0.788829044'],
['0.113663512', '1.57E-30', '0.093723681', '0.137651318', '1', '0.022380076'],
['0.150040332', '8.86E-22', '0.025954209', '0.503761429', '0.114915691'],
['0.002975743', '1.37E-36', '0.204703904', '0.490178969', '0.270629172', '0.024789062', '0.924140482'],
['0.12597847', '9.30E-07', '0.426378425', '0.67878964', '0.148126828', '0.01675463'],
['0.285209769', '0.0027832', '0.974167639', '0.803975443', '0.148028014', '0.958544896'],
['0.002565804', '0.020620068', '0.039344811', '0.903606351', '0.691051673', '0.551083278', '0.243547873'],
['0.06690143', '0.273364665'],
['0.074038248', '1.38E-07', '0.277879048', '0.509771534', '0.135622759'],
['1', '0.011610708', '1', '0.180175093'],
['0.648263954', '0.064202734', '0.966643691', '0.517553873', '0.521850513', '0.431327538'],
['0.442512217', '0.000135576', '0.117136698', '0.371889842', '0.267906474', '0.522211449', '0.68935266'],
['3.76E-26', '3.25E-77', '8.05E-35', '0.123347443', '3.45E-17', '1.80E-14', '1.46E-22'],
['3.49E-14', '6.22E-28', '2.81E-26', '0.096468323', '1.63E-08', '6.15E-13', '3.33E-09'],
['8.72E-12', '2.52E-31', '9.24E-22', '0.142381153', '3.01E-10', '1.60E-16', '1.75E-06'],
['0.173276747', '0.052381081', '0.000125768', '0.500923363', '0.270629172', '0.024721649', '0.168725849'],
['1.13E-26', '1.70E-60', '0.140417228', '1.59E-11', '1.29E-05', '1.08E-15'],
['6.14E-12', '2.22E-24', '0.214249987', '0.000139018', '0.001411376', '4.13E-05'],
['1.02E-11', '4.63E-05', '1.94E-298', '0.354093297', '6.79E-06', '0.00425326', '4.13E-05'],
['2.50E-05', '0.489890016', '4.32E-171', '0.84186216', '0.000156542', '0.008923657', '0.113222093']
]
# Loop over each list in tests
pooled=[]

for i, p_values in enumerate(tests, start=1):
    stat, combined_p = combine_pvalues(p_values, method='fisher')
    # print(f"{combined_p:.6e}")
    pooled.append(float(combined_p))

print(pooled)


pooled=[]
for p_values in tests:
    stat, combined_p = combine_pvalues(p_values, method='stouffer')
    pooled.append(float(combined_p))  # Convert to plain Python float

print(pooled)
